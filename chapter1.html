<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; 카이제곱(\chi^2) 검정 – 통알못을 위한 기초통계 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-375c9095c3150554df871ba417ef6047.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">통알못을 위한 기초통계 3</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">회귀분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">조절효과와 매개효과</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">로지스틱 회귀분석</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#카이제곱chi2-검정에-대해-알아보자" id="toc-카이제곱chi2-검정에-대해-알아보자" class="nav-link active" data-scroll-target="#카이제곱chi2-검정에-대해-알아보자"><span class="header-section-number">1.1</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정에 대해 알아보자</a>
  <ul class="collapse">
  <li><a href="#지금까지와-다른-것" id="toc-지금까지와-다른-것" class="nav-link" data-scroll-target="#지금까지와-다른-것"><span class="header-section-number">1.1.1</span> 지금까지와 다른 것</a></li>
  <li><a href="#카이제곱chi2-검정의-목적" id="toc-카이제곱chi2-검정의-목적" class="nav-link" data-scroll-target="#카이제곱chi2-검정의-목적"><span class="header-section-number">1.1.2</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정의 목적</a></li>
  <li><a href="#카이제곱chi2-계산식" id="toc-카이제곱chi2-계산식" class="nav-link" data-scroll-target="#카이제곱chi2-계산식"><span class="header-section-number">1.1.3</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 계산식</a></li>
  </ul></li>
  <li><a href="#일원-카이제곱one-way-chi2-test-검정을-계산해-보자" id="toc-일원-카이제곱one-way-chi2-test-검정을-계산해-보자" class="nav-link" data-scroll-target="#일원-카이제곱one-way-chi2-test-검정을-계산해-보자"><span class="header-section-number">1.2</span> 일원 카이제곱(One-way <span class="math inline">\(\chi^2\)</span> test) 검정을 계산해 보자</a></li>
  <li><a href="#이원-카이제곱one-way-chi2-test-검정을-계산해-보자" id="toc-이원-카이제곱one-way-chi2-test-검정을-계산해-보자" class="nav-link" data-scroll-target="#이원-카이제곱one-way-chi2-test-검정을-계산해-보자"><span class="header-section-number">1.3</span> 이원 카이제곱(One-way <span class="math inline">\(\chi^2\)</span> test) 검정을 계산해 보자</a>
  <ul class="collapse">
  <li><a href="#기본예제" id="toc-기본예제" class="nav-link" data-scroll-target="#기본예제"><span class="header-section-number">1.3.1</span> 기본예제</a></li>
  <li><a href="#추가예제" id="toc-추가예제" class="nav-link" data-scroll-target="#추가예제"><span class="header-section-number">1.3.2</span> 추가예제</a></li>
  </ul></li>
  <li><a href="#카이제곱-chi2-test-검정을-넘어서" id="toc-카이제곱-chi2-test-검정을-넘어서" class="nav-link" data-scroll-target="#카이제곱-chi2-test-검정을-넘어서"><span class="header-section-number">1.4</span> 카이제곱 (<span class="math inline">\(\chi^2\)</span> test) 검정을 넘어서</a>
  <ul class="collapse">
  <li><a href="#전제조건" id="toc-전제조건" class="nav-link" data-scroll-target="#전제조건"><span class="header-section-number">1.4.1</span> 전제조건</a></li>
  <li><a href="#주로-문제가-되는-경우" id="toc-주로-문제가-되는-경우" class="nav-link" data-scroll-target="#주로-문제가-되는-경우"><span class="header-section-number">1.4.2</span> 주로 문제가 되는 경우</a></li>
  <li><a href="#상대-위험도relative-risk" id="toc-상대-위험도relative-risk" class="nav-link" data-scroll-target="#상대-위험도relative-risk"><span class="header-section-number">1.4.3</span> 상대 위험도(Relative risk)</a></li>
  <li><a href="#교차비-or-오즈비odds-ratio" id="toc-교차비-or-오즈비odds-ratio" class="nav-link" data-scroll-target="#교차비-or-오즈비odds-ratio"><span class="header-section-number">1.4.4</span> 교차비 or 오즈비(Odds ratio)</a></li>
  </ul></li>
  <li><a href="#카이제곱-chi2-test-검정을-실습해-보자" id="toc-카이제곱-chi2-test-검정을-실습해-보자" class="nav-link" data-scroll-target="#카이제곱-chi2-test-검정을-실습해-보자"><span class="header-section-number">1.5</span> 카이제곱 (<span class="math inline">\(\chi^2\)</span> test) 검정을 실습해 보자</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="카이제곱chi2-검정에-대해-알아보자" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="카이제곱chi2-검정에-대해-알아보자"><span class="header-section-number">1.1</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정에 대해 알아보자</h2>
<section id="지금까지와-다른-것" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="지금까지와-다른-것"><span class="header-section-number">1.1.1</span> 지금까지와 다른 것</h3>
<p>지금까지 우리는 t-test, 분산분석(ANOVA)를 중심으로 공부해 왔습니다. 공통점이 있다면 종속변수는 연속변수(Continuous) 즉 양적변수(Quantitative)이고, 독립변수는 사실상 질적변수(Qualitative)였다는 점입니다. 즉, 독립변수는 2 개 혹은 3 개의 그룹이었고 종속변수만 연속변수였습니다. 그런데, 만약 독립변수와 종속변수 둘 다 명목척도 혹은 질적변수(Qualitative)라면 어떻게 될까요? 지금까지 배운 것으로 분석이 가능할까요?</p>
<p>그렇지 않습니다. 독립변수와 종속변수가 모두 질적변수일 경우 사용하는 방법이 바로 교차분석입니다. 영어로는 chi-square(<span class="math inline">\(\chi^2\)</span>) test라고 합니다. 앞서 우리가 보았던 t-test 혹은 분산분석의 F-test를 떠 올려본다면, 당연히 여기서는 <span class="math inline">\(\chi^2 \; \text{value}\)</span>와 <span class="math inline">\(\chi^2\)</span>분포가 있습니다. 이제 하나씩 알아보겠습니다.</p>
</section>
<section id="카이제곱chi2-검정의-목적" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="카이제곱chi2-검정의-목적"><span class="header-section-number">1.1.2</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정의 목적</h3>
<p>우선 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정은 언제하는 것일까요? 앞에서 이야기 한 것처럼 독립변수와 종속변수가 모두 명목척도 즉 질적변수인 경우입니다. 결론적으로 데이터는 사실상 개수(count)가 됩니다. 앞에서 공부한 t-test나 분산분석(ANOVA)의 목적은 둘 혹은 세 그룹의 평균값이 같은지 다른지 알고 싶을 때 하는 것이었습니다. 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정의 목적은 다소 달라집니다. 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정은 변수가 한 개인 경우에도 할 수 있는데, 변수의 그룹간 비율이 같은지 다른지 확인할 대 가능합니다. 만약 한 변수의 그룹이 2 개라면 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정보다 단순한 Binomial test라는 것을 합니다. 그룹이 3 개 이상인 경우에는 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정을 하게 됩니다. 또한 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정은 변수가 두 개인 경우에도 할 수 있는데, 두 변수 사이의 연관성(Association)을 보고자 할 때 카이제곱(<span class="math inline">\(\chi^2\)</span>) 검정을 사용합니다. 예를 들어 휴대폰 사용과 암의 발병율을 조사할 때 가능합니다.</p>
</section>
<section id="카이제곱chi2-계산식" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="카이제곱chi2-계산식"><span class="header-section-number">1.1.3</span> 카이제곱(<span class="math inline">\(\chi^2\)</span>) 계산식</h3>
<p><span class="math display">\[\chi^2 \; \text{value} = \Sigma \frac{(O - E)^2}{E}, \; \text{df} = \text{범주의 개수} - 1\]</span></p>
<p>위의 식에서 O는 관찰빈도(Observed frequency), E는 기대빈도(Expected frequency)입니다. 위의 식에서 관찰빈도는 데이터에서 자연스럽게 주어지는 값이 되고, 기대빈도는 별도의 방법을 이용해 구해야 합니다. 여기서 말하는 기대빈도란 개념적으로 설명하자면 어떤 특별한 이유가 없는한 이렇게 동일하게 나와야 한다는 일종의 기대수치와 같은 개념입니다. 에를 들어 고객 데이터에서 특별한 이유가 없는 한 남성고객과 여성고객의 빈도는 동일하게 나타나야 할 것이라고 가정하면, 총 1000명의 고객이 있을 경우 남성과 여성은 각각 500명씩 있어야 한다는 식의 개념이 바로 기대빈도입니다.</p>
<p>그럼 이제 조금 더 자세하게 알아보도록 하겠습니다.</p>
<p><a href="https://youtu.be/1ejeakac-t4">Youtube 바로 가기</a></p>
</section>
</section>
<section id="일원-카이제곱one-way-chi2-test-검정을-계산해-보자" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="일원-카이제곱one-way-chi2-test-검정을-계산해-보자"><span class="header-section-number">1.2</span> 일원 카이제곱(One-way <span class="math inline">\(\chi^2\)</span> test) 검정을 계산해 보자</h2>
<p>여기서 일원(one-way)는 변수가 1 개라는 의미입니다. 한 개의 변수가 당연히 명목척도/질적변수이어야 합니다. 당연히 이 명목척도는 2 개 이상의 범주를 가지고 있어야 하며 데이터 코딩을 할 때는 한 개의 변수이므로 하나의 열(column)에 넣어야 합니다. 다음과 같은 예를 들 수 있습니다.</p>
<ul>
<li>Payment method라는 변수는 총 4개의 범주로 구성(Bank transfer/Credit card/Electronic check/Mailed check)</li>
<li>고객의 지불방법에 따라 고객의 수가 차이가 나는지 알고 싶다면 일원 카이제곱(One-way <span class="math inline">\(\chi^2\)</span> test) 검정을 시행</li>
</ul>
<p>데이터는 다음과 같습니다.</p>
<div id="tbl-chi_data1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chi_data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1: 일원 카이제곱 검정 데이터
</figcaption>
<div aria-describedby="tbl-chi_data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Level</th>
<th style="text-align: center;">Count (빈도)</th>
<th style="text-align: center;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Bank transfer</td>
<td style="text-align: center;">1544</td>
<td style="text-align: center;">21.90%</td>
</tr>
<tr class="even">
<td style="text-align: center;">Credit card</td>
<td style="text-align: center;">1522</td>
<td style="text-align: center;">21.60%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Electronic check</td>
<td style="text-align: center;">2365</td>
<td style="text-align: center;">33.60%</td>
</tr>
<tr class="even">
<td style="text-align: center;">Mailed check</td>
<td style="text-align: center;">1612</td>
<td style="text-align: center;">22.90%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total (계)</td>
<td style="text-align: center;">7043</td>
<td style="text-align: center;">100.00%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>우리가 앞서 분산분석(ANOVA)에서 사용했던 데이터 중에서 독립변수입니다. 총 4 개의 범주가 있고 각 범주는 Bank transfer 21.9%, Credit card 21.6%, Electronic check 33.6%, Mailed check 22.9%로 구성되어 있습니다. <a href="#tbl-chi_data1" class="quarto-xref">Table&nbsp;<span>1.1</span></a> 에서 그냥 빈도라고 되어 있는 것이 카이제곱 검정에서는 관찰빈도(O)가 됩니다. 이제 기대빈도까지 계산한 표를 확인해 보겠습니다.</p>
<div id="tbl-chi_calc1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chi_calc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2: 일원 카이제곱 검정 계산법
</figcaption>
<div aria-describedby="tbl-chi_calc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Level</th>
<th style="text-align: center;">관찰빈도(O)</th>
<th style="text-align: center;">%</th>
<th style="text-align: center;">기대빈도(E)</th>
<th style="text-align: center;">(O – E)2÷E</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Bank transfer</td>
<td style="text-align: center;">1544</td>
<td style="text-align: center;">21.90%</td>
<td style="text-align: center;">1761</td>
<td style="text-align: center;">26.74</td>
</tr>
<tr class="even">
<td style="text-align: center;">Credit card</td>
<td style="text-align: center;">1522</td>
<td style="text-align: center;">21.60%</td>
<td style="text-align: center;">1761</td>
<td style="text-align: center;">32.44</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Electronic check</td>
<td style="text-align: center;">2365</td>
<td style="text-align: center;">33.60%</td>
<td style="text-align: center;">1761</td>
<td style="text-align: center;">207.16</td>
</tr>
<tr class="even">
<td style="text-align: center;">Mailed check</td>
<td style="text-align: center;">1612</td>
<td style="text-align: center;">22.90%</td>
<td style="text-align: center;">1761</td>
<td style="text-align: center;">12.61</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total (계)</td>
<td style="text-align: center;">7043</td>
<td style="text-align: center;">100.00%</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">278.95</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>기대빈도는 총 7043개의 데이터가 4 개의 범주에 동일한 비율로 분포되어 있을 것이라는 가정에 따라서 <span class="math inline">\(7043 \div 4 = 1760.75\)</span>가 되어 반올림하여 기대빈도는 각 1761로 정하였습니다. 이제 관찰빈도(O)와 기대빈도(E)를 사용하여 각 범주의 계산 값을 구해보면 위의 <a href="#tbl-chi_calc1" class="quarto-xref">Table&nbsp;<span>1.2</span></a> 의 마지막 열(column)에 정리되어 있습니다.</p>
<p>이제 <span class="math inline">\(\chi^2 \; \text{value} = 26.74 + 32.44 + 207.16 +12.61 = 278.95\)</span>가 됩니다. 이 경우 범주의 개수가 4 개이므로 <span class="math inline">\(df = 4 - 1 = 3\)</span>이 됩니다. 이 두 가지를 표기하는 방법은 다음과 같습니다.</p>
<p><span class="math display">\[\chi^2_{df=3} = 278.95\]</span></p>
<p>이때의 p-value를 구하려면 엑셀에서 chidist라는 함수를 사용하면 됩니다. 실제로 구해보면 거의 0에 가까운 값이 나와 매우 유의하다는 결과가 나옵니다. 카이제곱 검정 결과가 유의하다는 것은 무슨 뜻일까요?</p>
<p>이를 이해하려면 카이제곱 검정의 통계적 가설을 이해할 필요가 있습니다. 우리가 테스트한 내용을 통계적 가설로 쓰면 다음과 같습니다.</p>
<p><span class="math display">\[H_0: \text{P(Bank transfer)} = \text{P(Credit card)} = \text{P(Electronic check)} = \text{P(Mailed check)}\]</span> <span class="math display">\[H_a: \text{Proportion of 4 categories are not even}\]</span></p>
<p>귀무가설에서 P는 영어의 Proportion 즉 비율을 의미합니다. 여담입니다만, 가끔 ratio와 proportion이 뭐가 다르냐는 질문을 받습니다. 둘 다 한 개의 값을 다른 값으로 나눈 것이라는 계산 방식은 비슷합니다만, 일반적으로 ratio는 완전히 서로 다른 개념의 것을 나누어 비율로 표현한 것이라면, Proportion은 전체 중 특정한 부분이 차지하는 비율을 의미한다고 볼 수 있겟습니다. 즉, 여기서 네 개의 Proportion을 합치면 1이 되는 경우이므로 이런 경우에는 Proportion이라고 부릅니다.</p>
<p>그러므로 카이제곱 검정이 유의하다는 것은 비율이 각 범주 간에 동일하지 않다는 의미가 되는 것입니다. 사실 여기서 이야기 하는 유의하다는 것은 기대되는 비율 즉 모든 범주가 동일할 것이라는 기대에 다르다는 의미가 됩니다.</p>
<p>그러나 만약 기대빈도가 이론에 의해 사전적으로 1:1:1:1이 아니고 1:1:2:1이라면 기대빈도 자체가 애초에 다르게 설정되어 카이제곱 값이 계산되어야 합니다. 이 경우 20%:20%:40%:20%로 계산되어야 해서 1049:1049:2817:1049가 기대빈도로 사용되어야 합니다. 이런 이유로 카이제곱 검정을 적합도(goodness of fit)이라고 부르기도 합니다. 이런 이름은 한참 뒤에 나올 CFA나 SEM과 같은 곳에서 사용될 것입니다. 지금은 이정도만 이해하면 됩니다.</p>
<p><a href="https://youtu.be/xx1fRI5X69Y">Youtube 바로 가기</a></p>
</section>
<section id="이원-카이제곱one-way-chi2-test-검정을-계산해-보자" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="이원-카이제곱one-way-chi2-test-검정을-계산해-보자"><span class="header-section-number">1.3</span> 이원 카이제곱(One-way <span class="math inline">\(\chi^2\)</span> test) 검정을 계산해 보자</h2>
<section id="기본예제" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="기본예제"><span class="header-section-number">1.3.1</span> 기본예제</h3>
<p>이원 카이제곱 검정(Two-way <span class="math inline">\(\chi^2\)</span> test)에서 Two-way란 Two-way ANOVA와 같이 변수가 2개라는 의미입니다. 두 개의 변수 모두 당연히 명목척도 (Qualitative variable)이고, 이 두 명목척도는 2개 이상의 범주(category)를 가지게 됩니다. 즉 두 개 이상의 그룹을 각 변수가 가지고 있다는 의미입니다. 변수가 두 개 이므로 당연히 데이터 코딩 시 두 개의 열(column)에 코딩해야 합니다. 이 때의 가장 단순한 형태는 <span class="math inline">\(2 \times 2\)</span>가 될 것입니다. 즉, 각각 두 개의 그룹을 가지고 있는 두 변수를 의미 합니다. 이 경우 이를 표현하는 방법이 바로 분할표 (contingency table)입니다. 분할표란 데이터의 빈도만 표에 작성하는 것을 말하는데, 분할표는 두개의 변수를 행(Row)과 열(Column)으로 나누어 빈도를 정리합니다. 이 분할표를 통해 이원 카이제곱 검정을 할 때의 목적은 행과 열 사이에 (즉 두 변수 사이에) 어떠한 연관성이 있는지 확인해보는 것입니다.</p>
<p>다음은 우리가 사용할 예제입니다. 200명의 암환자를 임의 추출하여 다음의 두 가지를 조사했습니다.</p>
<ul>
<li>진단받은 암이 Brain cancer인지의 여부: Yes or No</li>
<li>암을 진단받았을 때 휴대폰을 사용한지 3년 이상 되었는지의 여부: Yes or No</li>
</ul>
<p>이를 바탕으로 다음의 <span class="math inline">\(2 \times 2\)</span> 분할표를 작성하였습니다.</p>
<div id="fig-img9.1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img9.1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img9.1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: 이원 카이제곱 검정 분할표
</figcaption>
</figure>
</div>
<p>그렇다면 위의 표를 바탕으로 몇 가지 단순한 사실을 알아보겠습니다. 만약 Brain cancer와 cell phone의 사용 사이에 어떤 관련이 있으려면 전체 Brain cancer 환자의 몇 퍼센트가 3년 이상 cell phone을 사용했는지 알아볼 필요가 있습니다. 이를 통계적인 언어로 표현하면 다음과 같습니다.</p>
<p><span class="math display">\[P(CP | BC) = 18 \div 25 = 0.72\]</span></p>
<p>위에서 P()는 일반적으로 확률(Probability)를 의미합니다만, 사실 여기서는 정확하게 말하자면 Proportion이라고 보는 편이 나을 것 같습니다. 다만 설명의 편의를 위해 확률이라고 이야기하겠습니다. CP는 Cell phone을 BC는 Brain cancer를 의미합니다. 그러므로 총 Brain cancer 환자 25명 중 18명이 3년 이상 cell phone을 사용했다는 것을 알 수 있고 이를 확률로 계산해보니 72%정도가 됩니다. 반면에 다른 암 환자 중에서 3년 이상 cell phone을 사용한 사람을 조사해 보면 다음과 같습니다. 다음 암 환자 총 175명 중 80명이 3년 이상 cell phone을 사용하여 46%의 확률을 보였습니다.</p>
<p><span class="math display">\[P(CP | NBC) = 80 \div 175 = 0.46\]</span></p>
<p>이제 이원 카이제곱 검정을 계산해 보도록 하겠습니다. 일단 이 예제에서 이원 카이제곱 검정의 목적은 Brain cance와 cell phone의 연관성(association)을 알아 보는 것입니다. 여기서 조심해야 할 것이 바로 연관성이라는 단어입니다. 가끔 신문 기사나 혹은 심지어 논문 분석 결과에서 이 연관성을 인과관계로 보고 해석하는 경우가 있는데 이는 사실 조심해야할 부분입니다. 연관성이 있다와 인과관계가 있다는 비슷해 보여도 분명 다른 것입니다. 연관성이 있다고 해서 인과관계가 있는 것은 아니라는 의미입니다. 여기서는 <span class="math inline">\(2 \times 2\)</span>분할표를 사용해서 계산할 것입니다. 이원 카이제곱 검정의 통계적 가설을 다음과 같습니다.</p>
<p><span class="math display">\[H_0: \text{Brain cancer와 cell phone 사용 간에는 연관성이 없다}\]</span></p>
<p><span class="math display">\[H_a: \text{Brain cancer와 cell phone 사용 간에는 연관성이 있다}\]</span></p>
<p>앞서 일원 카이제곱 검정에서 보았듯이 이 테스트를 하려면 기본적으로 데이터에서 구해진 빈도와 기대빈도(E)를 알아야 <span class="math inline">\(\chi^2\)</span>값을 구할 수 있습니다. 기대빈도 계산법은 다음과 같습니다.</p>
<p><span class="math display">\[E(\text{기대빈도}) = \frac{\text{(Row Total)} \times \text{(Column Total)}}{\text{Grand Total}} = \frac{\text{(행합계)} \times \text{(열합계)}}{\text{총합계}}\]</span></p>
<p>위의 계산을 바탕으로 기대빈도를 작성한 표는 다음과 같습니다.</p>
<div id="fig-img9.2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img9.2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img9.2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: 이원 카이제곱 검정 기대빈도
</figcaption>
</figure>
</div>
<p>위에서 계산된 내용을 다시 살펴보면 다음과 같습니다.</p>
<p><span class="math display">\[E(CP\&amp;BC) = \frac{98 \times 25}{200} = 12.25\]</span></p>
<p><span class="math display">\[E(CP\&amp;NBC) = \frac{98 \times 175}{200} = 85.75\]</span></p>
<p><span class="math display">\[E(NCP\&amp;BC) = \frac{102 \times 25}{200} = 12.75\]</span></p>
<p><span class="math display">\[E(NCP\&amp;NBC) = \frac{102 \times 175}{200} = 89.25\]</span></p>
<p>이제 <a href="#fig-img9.1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> 과 <a href="#fig-img9.2" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> 를 이용해 <span class="math inline">\(\chi^2\)</span>값을 계산해 보겠습니다.</p>
<p><span class="math display">\[\begin{matrix}
  \chi^2 &amp;=&amp; \frac{(18-12.25)^2}{12.25} + \frac{(7-12.75)^2}{12.75} \\
         &amp;&amp;  + \frac{(80-85.75)^2}{85.75} + \frac{(95-89.25)^2}{89.25} \\
         &amp;=&amp; \small{6.048}
  \end{matrix}\]</span></p>
<p><span class="math display">\[df = (2-1) \times (2-1) = 1 \]</span></p>
<p><span class="math display">\[\chi^2_{df=1} = 6.048, \;p-value = 0.014\]</span></p>
<p>그러므로 Brain cancer와 cell phone 사용 간에는 어떤 연관성이 있다고 결론 내릴 수 있습니다. 물론 조심할 것은 여기서 인과관계가 있다라고 해석하면 곤란합니다. 만약 이 결과를 놓고 Brain cancer의 원인이 cell phone 사용 때문이라고 하면 이는 우리의 통계적 분석 결과를 뛰어 넘는 과도한 해석이 됩니다. 문제는 제가 한국에서 이런 논문을 꽤 많이 봤다는 사실입니다. 인과관계를 이야기 하려면 사실 이런 단순한 카이제곱 검정만으로는 부족하다고 할 수 있습니다.</p>
</section>
<section id="추가예제" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="추가예제"><span class="header-section-number">1.3.2</span> 추가예제</h3>
<p>그렇다면 추가적인 예제를 하나 더 보겠습니다.</p>
<p>어떤 보험사에서 지진보험을 상품으로 판매하고 있습니다. 이 보험사는 지진의 위험성이 지역적으로 차이가 있을 것으로 보고 이에따라 지역별로 지진보험 가입 정도가 다를 가능성이 있을 것이라는 가설을 통계적으로 분석해보고자 합니다. 이를 위해 총 4 개 지역의 지진보험 가입유무를 조사한 결과를 정리한 표가 아래와 같이 있습니다.</p>
<div id="fig-im9.3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-im9.3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-im9.3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: 지진보험 가입현황
</figcaption>
</figure>
</div>
<p>위의 지진보험 가입현황에 대한 기대빈도는 아래와 같습니다.</p>
<div id="fig-im9.4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-im9.4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-im9.4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: 지진보험 가입 기대빈도
</figcaption>
</figure>
</div>
<p>위의 두 종류의 값을 이용하여 <span class="math inline">\(\chi^2\)</span>값을 구하면 다음과 같습니다. 가능하다면 엑셀을 이용하여 직접 계산해 보는 것을 권해드립니다. 눈으로 보고 넘어가는 것 보다는 직접 계산을 해보면 보다 이해가 잘 되고 기억에도 남습니다.</p>
<p><span class="math display">\[\chi^2_{df=3} = 47.105, \; p-value &lt; 0.05 \]</span></p>
<p>그러므로 지진보험 가입 유무는 거주지역과 연관성이 있다고 결론 내릴 수 있습니다. 다만 문제는 이 연관성 즉 지역별 가입 유무의 차이정도가 얼마나 되는지는 카이제곱 검정만으로는 알 수 없습니다. 또한 지역적 차이를 일대일로 알아내기는 불가능합니다. 이제 기본적인 카이제곱 검정은 다 알아보았습니다. 이제 카이제곱 검정과 관련이 있는 보다 어려운 내용에 대해 알아보도록 하겠습니다.</p>
<p><a href="https://youtu.be/i6BQAX5MJ4U">Youtube 바로 가기</a></p>
</section>
</section>
<section id="카이제곱-chi2-test-검정을-넘어서" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="카이제곱-chi2-test-검정을-넘어서"><span class="header-section-number">1.4</span> 카이제곱 (<span class="math inline">\(\chi^2\)</span> test) 검정을 넘어서</h2>
<p>여기서는 카이제곱 검정의 전제조건과 한계점 그리고 이를 해결하기 위한 방법을 간단하게 알아보고, 카이제곱검정과 관련이 있지만 다소 복잡한 방법에 대해 알아보겠습니다. 일반적인 카이제곱 검정보다는 여기서 배우는 방법이 조금 더 낫다는 생각이 들긴 합니다.</p>
<section id="전제조건" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="전제조건"><span class="header-section-number">1.4.1</span> 전제조건</h3>
<p>카이제곱 검정의 몇 가지 전제조건은 다음과 같습니다.</p>
<ol type="1">
<li>랜덤 샘플링: 당연한 이야기 이지만 의외로 랜덤 샘플링이라는 조건이 연구를 하다보면 쉽지 않다는 사실을 알게 됩니다.</li>
<li>독립셩</li>
</ol>
<ul>
<li>여기서 독립성이란 변순 내의 각 범주가 서로 상호 배타적이어야 한다는 의미입니다. 즉 한 관찰값이 여러 개의 범주에 동시에 해당될 수 없다는 의미 입니다.</li>
</ul>
<ol start="3" type="1">
<li>분할표 상의 각 셀의 기대빈도는 적어도 5 이상이어야 한다.</li>
</ol>
<ul>
<li>그러므로 경우에 따라서는 기대빈도를 5 이상으로 맞추기 위해 볌주를 합쳐야 할 수도 있습니다.</li>
<li>만약 범주를 합치는 것이 불가능 하다면, 피셔의 정확검정을 하거나 Likelihood ratio test를 해야합니다.</li>
</ul>
</section>
<section id="주로-문제가-되는-경우" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="주로-문제가-되는-경우"><span class="header-section-number">1.4.2</span> 주로 문제가 되는 경우</h3>
<p>주로 문제가 되는 경우는 df가 1인 경우입니다. 즉 범주가 단 2 개인 경우를 의미합니다. 예를 들어 이원 카이제곱 검정을 할 때 <span class="math inline">\(2 \times 2\)</span>인 경우가 해당됩니다. 문제는 비연속성의 조건부 확률을 연속성의 <span class="math inline">\(\chi^2\)</span>분포에 적용함으로써 발생되는데, 이런 경우 일원 카이제곱 검정이라면 연속성을 보정하는 Yate’s correction 혹은 <span class="math inline">\(\chi^2\)</span> continuity correction이라는 것을 해야합니다. 만약 이원 카이제곱 검정이라면 검정 결과와 Yate’s correction의 결과가 다를 경우 피셔의 정확검정을 사용하는 것이 좋습니다. 사실 이런 경우는 정확히 표현하자면 어쩔 수 없는 경우가 아니라면 카이제곱 검정을 하지 않는 것이 현실적으로는 옳은 판단일 수 있습니다.</p>
</section>
<section id="상대-위험도relative-risk" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="상대-위험도relative-risk"><span class="header-section-number">1.4.3</span> 상대 위험도(Relative risk)</h3>
<p>상대 위험도란 두 확률의 차이인 <span class="math inline">\(P_1 - P_2\)</span>가 아니라 <span class="math inline">\(P_1 \div P_2\)</span>를 의미하고 주로 의학쪽에서 많이 사용합니다. 만약 상대 위험도가 1 이라면 두 사건이 발생할 확률은 동일하고 1보다 크다면 위험이 증가한다고 보고, 1보다 작다면 위험이 감소한다고 해석합니다.</p>
<p>앞서 본 예제를 다시 이용해서 상대 위험도를 설명해 보자면 다음과 같습니다.</p>
<div id="fig-img9.5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img9.5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img9.5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: 상대위험도
</figcaption>
</figure>
</div>
<p>휴대폰 사용자 중 Brain cancer의 확률은 <span class="math inline">\(P(BC|CP) = 18 \div 98 = 0.184\)</span> 이고 휴대폰 비사용자 중 Brain cancer의 확률은 <span class="math inline">\(P(BC|NCP) = 7 \div 102 = 0.069\)</span>가 되어 상대위험도는 다음과 같습니다.</p>
<p><span class="math display">\[\text{상대위험도(Relative risk: RR)} = 0.184 \div 0.069 = 2.67\]</span></p>
<p>이는 휴대폰 사용자가 그렇지 않는 사람에 비해 약 2.67배 Brain cancer에 걸릴 확률이 높다고 해석합니다.</p>
</section>
<section id="교차비-or-오즈비odds-ratio" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="교차비-or-오즈비odds-ratio"><span class="header-section-number">1.4.4</span> 교차비 or 오즈비(Odds ratio)</h3>
<p>오즈비를 이해하려면 먼저 오즈(odds)에 대해 알아야 합니다. 사전적으로는 오즈(odds)란 확률을 의미하지만 통계에서 오즈(odds)는 확률과 조금 다르게 계산됩니다.</p>
<p><span class="math display">\[Odds = \frac{p}{1-p}\]</span></p>
<p>여기서 <span class="math inline">\(p\)</span>는 어떤 사건이 발생할 확률을 의미합니다. 이를 해석하기 위해 두 가지 예를 들어보겠습니다.</p>
<ol type="1">
<li>예제 1</li>
</ol>
<ul>
<li>만약 어떤 사건이 일어날 확률 <span class="math inline">\(p\)</span>가 <span class="math inline">\(\frac{1}{2}\)</span>이라면 오즈(odds)는 <span class="math inline">\(\frac{1}{2} \div \frac{1}{2} = 1\)</span></li>
<li>이는 어떤 사건이 일어날 확률이 <span class="math inline">\(\frac{1}{2}\)</span>이라면 오즈(odds)가 의미하는 것은 이 사건이 일어나지 않을 확률 대비 일어날 확률은 동일하다는 의미</li>
</ul>
<ol start="2" type="1">
<li>예제 2</li>
</ol>
<ul>
<li>만약 어떤 사건이 일어날 확률 <span class="math inline">\(p\)</span>가 <span class="math inline">\(\frac{3}{4}\)</span>이라면 오즈(odds)는 <span class="math inline">\(\frac{3}{4} \div \frac{1}{4} = 3\)</span></li>
<li>이는 어떤 사건이 일어날 확률이 <span class="math inline">\(\frac{3}{4}\)</span>이라면 오즈(odds)가 의미하는 것은 이 사건이 일어나지 않을 확률 대비 일어날 확률은 3배 높다는 의미</li>
</ul>
<p>그렇다면 오즈비(odds ratio)란 두 오즈(odds)의 비율을 의미합니다.</p>
<p><span class="math display">\[\theta = \frac{\frac{P(A|B)}{1-P(A|B)}}{\frac{P(A|C)}{1-P(A|C)}}\]</span></p>
<p>앞의 상대 위험도와 같은 방법으로 오즈비를 구해보겠습니다.</p>
<p>휴대폰 사용자 중 Brain cancer의 확률은 <span class="math inline">\(P(BC|CP) = 18 \div 98 = 0.184\)</span> 이고 휴대폰 비사용자 중 Brain cancer의 확률은 <span class="math inline">\(P(BC|NCP) = 7 \div 102 = 0.069\)</span>가 되어 오즈비는 다음과 같습니다.</p>
<p><span class="math display">\[\theta = \frac{\frac{P(A|B)}{1-P(A|B)}}{\frac{P(A|C)}{1-P(A|C)}} = \frac{\frac{0.184}{0.816}}{\frac{0.069}{0.931}} = \frac{0.225}{0.074} = 3.04\]</span></p>
<p>Brain cancer가 발생할 오즈는 휴대폰 사용자가 그렇지 않은 사람보다 약 3배 정도 높다는 의미가 됩니다.</p>
<p>이제 오즈비의 장점을 알아보겠습니다. 같은 데이터에서 만약 확률을 행에서 열로 바꾸면 어떻게 될까요? 즉, Brain cancer 환자 중에서 휴대폰 사용자의 확률과 다른 암 환자 중에서 휴대폰 사용자의 확률을 이용하면,</p>
<p><span class="math display">\[P(CP|BC) = 18 \div 25 = 0.72\]</span></p>
<p><span class="math display">\[P(CP|NBC) = 80 \div 175 = 0.457\]</span></p>
<p><span class="math display">\[\theta = \frac{\frac{P(A|B)}{1-P(A|B)}}{\frac{P(A|C)}{1-P(A|C)}} = \frac{\frac{0.72}{0.28}}{\frac{0.457}{0.543}} = \frac{2.57}{0.842} = 3.05\]</span></p>
<p>즉, 휴대폰을 가지고 있을 오즈는 Brain cancer 환자가 다른 암 환자 보다 약 3배 정도 높다는 의미가 됩니다. 결론적으로 행과 열을 바꾸어서 계산해 보아도 오즈비는 거의 비슷하게 나오는 특징이 있습니다. 결국 데이터의 영향에 매우 덜 민감한 반면, 이를 단순 오즈(odds)나 상대 위험도로 계산해 보면 크게 숫자가 변하는 것을 알 수 있습니다.</p>
<p>마지막으로 쉽게 <span class="math inline">\(2 \times 2\)</span>의 오즈비를 계산하는 방법을 이야기하고 마치겠습니다.</p>
<div id="fig-img9.6" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-img9.6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img9-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-img9.6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: 오즈비 쉽게 계산하는 법
</figcaption>
</figure>
</div>
<p><span class="math display">\[\theta = \frac{n_{11} \times n_{22}}{n_{12} \times n_{21}} = \frac{18 \times 95}{80 \times 7} = 3.05\]</span></p>
<p>이런식으로 계산할 수 있습니다.</p>
<p><a href="https://youtu.be/LMseXGG_cRY">Youtube 바로 가기</a></p>
</section>
</section>
<section id="카이제곱-chi2-test-검정을-실습해-보자" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="카이제곱-chi2-test-검정을-실습해-보자"><span class="header-section-number">1.5</span> 카이제곱 (<span class="math inline">\(\chi^2\)</span> test) 검정을 실습해 보자</h2>
<p>실습용 데이터는 앞서 분산분석에서 사용한 적이 있는 Telco Customer Churn 데이터를 사용하겠습니다. 캐글(www.kaggle.com)에 들어가서 검색해 보시면 찾으실 수 있습니다. 어려우신 분들은 여기서 <a href="https://github.com/who4u78/Ko_stat_sample_data/blob/master/6.%20%EC%B9%B4%EC%9D%B4%EC%A0%9C%EA%B3%B1%EA%B2%80%EC%A0%95%20%EC%83%98%ED%94%8C%EB%8D%B0%EC%9D%B4%ED%84%B0/WA_Fn-UseC_-Telco-Customer-Churn.csv">다운로드</a> 받으시기 바랍니다.</p>
<p><a href="https://youtu.be/X4s8Z35Dofo">Youtube 바로 가기</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="서문">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">서문</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="회귀분석">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">회귀분석</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>